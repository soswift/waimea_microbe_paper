"0","# list of unique trophic levels"
"0","trophic_types <- unique(MM_16S_phy@sam_data$trophic)"
"0","# function to subset and ordinate each trophic level"
"0","ordinate_troph <- function(x){"
"0","  "
"0","  # superassign variable to make it accessible to phyloseq commands"
"0","  troph <<- x"
"0","  "
"0","  # subset and ordinate"
"0","  MM_sub <- subset_samples(MM_16S_phy, trophic == troph)"
"0","  MM.ord <- ordinate(MM_sub, ""NMDS"", ""bray"")"
"0","  "
"0","  #plot"
"0","  p <- plot_ordination(MM_sub, MM.ord, type=""samples"", color = ""elevation"", shape = ""habitat"", title= paste(""NMDS, Bray,"", troph))  +"
"0","    uniform_gradient_color()+"
"0","    scale_shape_discrete(solid = T)"
"0","  return(p)"
"0","}"
"0","# run function"
"0","trophic_plots <- lapply(trophic_types, ordinate_troph)"
"1","Run 0 stress"
"1"," "
"1","0.1870196"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.1920977"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.1904005"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.1859133"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.02002231"
"1"," "
"1"," max resid"
"1"," "
"1","0.1513645"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.1931709"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.1857049"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.01787119"
"1"," "
"1"," max resid"
"1"," "
"1","0.1534904"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.1874294"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.1864194"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.1889511"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.1895738"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.1887831"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.1785515"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.01609846"
"1"," "
"1"," max resid"
"1"," "
"1","0.1545539"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.1826948"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.1962599"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.1833553"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.1873761"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.1968521"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.1868713"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.1910097"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.183553"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.1796603"
"1"," "
"1","
"
"1","*** No convergence -- monoMDS stopping criteria:
"
"1","     1: no. of iterations >= maxit
"
"1","    10: stress ratio > sratmax
"
"1","     9: scale factor of the gradient < sfgrmin
"
"1","Run 0 stress"
"1"," "
"1","0.1542948"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.1704441"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.1659233"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.1627113"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.1639425"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.1624255"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.1602539"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.162497"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.1583793"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.1641157"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.1592579"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.1631799"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.1610058"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.1629251"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.1636204"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.1669637"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.1631104"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.1654798"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.1645803"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.1613822"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.1646709"
"1"," "
"1","
"
"1","*** No convergence -- monoMDS stopping criteria:
"
"1","     9: stress ratio > sratmax
"
"1","    11: scale factor of the gradient < sfgrmin
"
"1","Run 0 stress"
"1"," "
"1","0.1778167"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.1802632"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.1836406"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.184257"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.1884034"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.1803634"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.1853404"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.1893453"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.1802337"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.1808152"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.1827317"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.1796394"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.1891098"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.1831943"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.1853437"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.1787873"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.1812529"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.1754086"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.02814542"
"1"," "
"1"," max resid"
"1"," "
"1","0.1250901"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.1831515"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.1865262"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.1830675"
"1"," "
"1","
"
"1","*** No convergence -- monoMDS stopping criteria:
"
"1","     3: no. of iterations >= maxit
"
"1","    14: stress ratio > sratmax
"
"1","     3: scale factor of the gradient < sfgrmin
"
"1","Run 0 stress"
"1"," "
"1","0.2635105"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.2710273"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.2536629"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.04675827"
"1"," "
"1"," max resid"
"1"," "
"1","0.2485159"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.2494914"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.03227251"
"1"," "
"1"," max resid"
"1"," "
"1","0.2350036"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.2580121"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.2586211"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.2629508"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.2611338"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.2551471"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.255146"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.2556138"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.2649248"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.2760739"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.2613161"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.2584046"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.2565612"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.2559348"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.2633061"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.2717684"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.2690907"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.255912"
"1"," "
"1","
"
"1","*** No convergence -- monoMDS stopping criteria:
"
"1","     1: no. of iterations >= maxit
"
"1","    19: stress ratio > sratmax
"
"1","Run 0 stress"
"1"," "
"1","0.234825"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.2295519"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.03442851"
"1"," "
"1"," max resid"
"1"," "
"1","0.2069436"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.2382986"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.2439843"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.2397071"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.2356579"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.24184"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.2297502"
"1"," "
"1","
"
"1","... Procrustes: rmse"
"1"," "
"1","0.006616952"
"1"," "
"1"," max resid"
"1"," "
"1","0.06312216"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.2345756"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.2390595"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.2373161"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.2366508"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.2371337"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.2333222"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.2363109"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.2295499"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.001190389"
"1"," "
"1"," max resid"
"1"," "
"1","0.01109955"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.2334257"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.2312594"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.228138"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.03567402"
"1"," "
"1"," max resid"
"1"," "
"1","0.1379513"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.2359984"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.2310754"
"1"," "
"1","
"
"1","*** No convergence -- monoMDS stopping criteria:
"
"1","     5: no. of iterations >= maxit
"
"1","    15: stress ratio > sratmax
"
"1","Run 0 stress"
"1"," "
"1","0.1702501"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.1778313"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.1901411"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.1686606"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.02020577"
"1"," "
"1"," max resid"
"1"," "
"1","0.07172407"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.1651894"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.08695175"
"1"," "
"1"," max resid"
"1"," "
"1","0.2574404"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.1951756"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.1778313"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.1898195"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.1690769"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.1615109"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.0421109"
"1"," "
"1"," max resid"
"1"," "
"1","0.1509334"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.2376649"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.1797433"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.1778313"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.1686607"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.1702501"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.196857"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.1868477"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.1686605"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.1778313"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.1951754"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.1656806"
"1"," "
"1","
"
"1","*** No convergence -- monoMDS stopping criteria:
"
"1","    20: stress ratio > sratmax
"
"0","# display plots"
"0","trophic_plots"
"1","[[1]]
"
"1","
"
"1","[[2]]
"
"1","
"
"1","[[3]]
"
"1","
"
"1","[[4]]
"
"1","
"
"1","[[5]]
"
"1","
"
"1","[[6]]
"
"1","
"
